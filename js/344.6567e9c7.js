(self["webpackChunkegu2022"]=self["webpackChunkegu2022"]||[]).push([[344],{25643:function(e){e.exports=!1},58908:function(e,t,n){var r;r="undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},e.exports=r},27376:function(e){e.exports=n;var t=Object.prototype.toString;function n(e){if(!e)return!1;var n=t.call(e);return"[object Function]"===n||"function"===typeof e&&"[object RegExp]"!==n||"undefined"!==typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}},53030:function(e,t){"use strict";t.CODE_P2P=421,t.CODE_CIRCUIT=290,e.exports.CLOSE_TIMEOUT=2e3},27344:function(e,t,n){"use strict";const r=n(11227),o=n(11227),s=o("libp2p:webrtcdirect");s.error=o("libp2p:webrtcdirect:error");const i=n(32114),c=n(56942),a=n(33298),u=n(25643),d=n(29175),{base58btc:l}=n(99086),p=n(41875),f=n(98514),{AbortError:m}=n(61623),{toString:w}=n(92263),{fromString:g}=n(52217),{CODE_CIRCUIT:b,CODE_P2P:y}=n(53030),h=n(76014),v=n(15460);function E(){}class R{constructor({upgrader:e}){r(e,"An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader."),this._upgrader=e}async dial(e,t={}){const n=await this._connect(e,t),r=h(n,{remoteAddr:e,signal:t.signal});s("new outbound connection %s",r.remoteAddr);const o=await this._upgrader.upgradeOutbound(r);return s("outbound connection %s upgraded",r.remoteAddr),o}_connect(e,t={}){if(t.signal&&t.signal.aborted)throw new m;return t={initiator:!0,trickle:!1,wrtc:u?c:void 0,...t},new Promise(((n,r)=>{const o=Date.now();let c;const u=e.toOptions();s("Dialing %s:%s",u.host,u.port);const d=new a(t),f=e=>{if(!c){const t=`connection error ${u.host}:${u.port}: ${e.message}`;s.error(t),e.message=t,v(e)}},b=()=>{s("connnection timeout %s:%s",u.host,u.port);const e=i(new Error(`connection timeout after ${Date.now()-o}ms`),"ERR_CONNECT_TIMEOUT");d.emit("error",e)},y=()=>{c=!0,s("connection opened %s:%s",u.host,u.port),v(null)},h=()=>{s.error("connection aborted %s:%s",u.host,u.port),d.destroy(),v(new m)},v=e=>{d.removeListener("error",f),d.removeListener("timeout",b),d.removeListener("connect",y),d.removeAllListeners("signal"),t.signal&&t.signal.removeEventListener("abort",h),e?r(e):n(d)};d.once("error",f),d.once("timeout",b),d.once("connect",y),d.on("close",(()=>d.destroy())),t.signal&&t.signal.addEventListener("abort",h),d.on("signal",(e=>{const t=JSON.stringify(e),n="http://"+u.host+":"+u.port,o="/?signal="+l.encode(g(t)),s=n+o;p.get(s,((e,t)=>{if(e)return r(e);const n=l.decode(t.body),o=w(n),s=JSON.parse(o);d.signal(s)}))}))}))}createListener(e={},t){if(!u)throw i(new Error("Can't listen if run from the Browser"),"ERR_NO_SUPPORT_FROM_BROWSER");return"function"===typeof e&&(t=e,e={}),t=t||E,v({handler:t,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter((e=>!e.protoCodes().includes(b)&&d.WebRTCDirect.matches(e.decapsulateCode(y))))}}e.exports=f(R,{className:"WebRTCDirect",symbolName:"@libp2p/js-libp2p-webrtc-direct/webrtcdirect"})},15460:function(e,t,n){"use strict";var r=n(48764)["Buffer"];const o=n(33609),s=n(17187),i=n(11227),c=i("libp2p:webrtcdirect:listener");c.error=i("libp2p:webrtcdirect:listener:error");const a=n(25643),u=n(56942),d=n(33298),{base58btc:l}=n(99086),{toString:p}=n(92263),{fromString:f}=n(52217),m=n(489),w=n(76014);function g(e,t){e.__connections.push(t);const n=()=>{e.__connections=e.__connections.filter((e=>e!==t))};t.conn.once("close",n)}e.exports=({handler:e,upgrader:t},n={})=>{const i=new s,b=o.createServer();let y;return i.__connections=[],b.on("request",(async(o,s)=>{s.setHeader("Content-Type","text/plain"),s.setHeader("Access-Control-Allow-Origin","*");const b=o.url,y=b.split("?signal=")[1],h=l.decode(y),v=JSON.parse(p(h));n={trickle:!1,wrtc:a?u:void 0,...n};const E=new d(n),R=w(E,{remoteAddr:m(o.connection.remoteAddress,o.connection.remotePort)});let A;c("new inbound connection %s",R.remoteAddr),E.on("error",(e=>{c.error(`incoming connectioned errored with ${e}`)})),E.once("close",(()=>{E.removeAllListeners("error")})),E.on("signal",(e=>{const t=JSON.stringify(e),n=l.encode(f(t));s.end(r.from(n))})),E.signal(v);try{A=await t.upgradeInbound(R)}catch(T){return c.error("inbound connection failed to upgrade",T),R.close()}c("inbound connection %s upgraded",R.remoteAddr),g(i,R),E.on("connect",(()=>{i.emit("connection",A),e(A),E.removeAllListeners("connect"),E.removeAllListeners("signal")}))})),b.on("error",(e=>i.emit("error",e))),b.on("close",(()=>i.emit("close"))),i.listen=e=>{y=e;const t=e.toOptions();return new Promise(((e,n)=>{b.on("listening",(r=>{if(r)return n(r);i.emit("listening"),c("Listening on %s %s",t.port,t.host),e()})),b.listen(t)}))},i.close=async()=>{if(b.listening)return await Promise.all(i.__connections.map((e=>e.close()))),new Promise(((e,t)=>{b.close((n=>n?t(n):e()))}))},i.getAddrs=()=>[y],i}},76014:function(e,t,n){"use strict";const r=n(61623),o=n(79407),{CLOSE_TIMEOUT:s}=n(53030),i=n(489),c=n(11227),a=c("libp2p:webrtcdirect:socket");a.error=c("libp2p:webrtcdirect:socket:error"),e.exports=(e,t={})=>{const{sink:n,source:c}=o.duplex(e),u={async sink(e){t.signal&&(e=r(e,t.signal));try{await n(async function*(){for await(const t of e)yield t instanceof Uint8Array?t:t.slice()}())}catch(o){"aborted"!==o.type&&a.error(o)}},source:t.signal?r(c,t.signal):c,conn:e,localAddr:e.localAddress&&e.localPort?i(e.localAddress,e.localPort):void 0,remoteAddr:t.remoteAddr,timeline:{open:Date.now()},close(){if(!e.destroyed)return new Promise(((t,n)=>{const r=Date.now(),o=setTimeout((()=>{if(u.remoteAddr){const{host:e,port:t}=u.remoteAddr.toOptions();a("timeout closing socket to %s:%s after %dms, destroying it manually",e,t,Date.now()-r)}e.destroyed||e.destroy()}),s);e.once("close",(()=>{t()})),e.end((e=>{if(clearTimeout(o),u.timeline.close=Date.now(),e)return n(e)}))}))}};return e.once("close",(()=>{u.timeline.close||(u.timeline.close=Date.now())})),u}},4947:function(e){var t=function(e){return e.replace(/^\s+|\s+$/g,"")},n=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};for(var r={},o=t(e).split("\n"),s=0;s<o.length;s++){var i=o[s],c=i.indexOf(":"),a=t(i.slice(0,c)).toLowerCase(),u=t(i.slice(c+1));"undefined"===typeof r[a]?r[a]=u:n(r[a])?r[a].push(u):r[a]=[r[a],u]}return r}},41875:function(e,t,n){"use strict";var r=n(58908),o=n(27376),s=n(4947),i=n(47529);function c(e,t){for(var n=0;n<e.length;n++)t(e[n])}function a(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function u(e,t,n){var r=e;return o(t)?(n=t,"string"===typeof e&&(r={uri:e})):r=i(t,{uri:e}),r.callback=n,r}function d(e,t,n){return t=u(e,t,n),l(t)}function l(e){if("undefined"===typeof e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,r,o){t||(t=!0,e.callback(n,r,o))};function r(){4===f.readyState&&setTimeout(c,0)}function o(){var e=void 0;if(e=f.response?f.response:f.responseText||p(f),v)try{e=JSON.parse(e)}catch(t){}return e}function i(e){return clearTimeout(m),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,E)}function c(){if(!l){var t;clearTimeout(m),t=e.useXDR&&void 0===f.status?200:1223===f.status?204:f.status;var r=E,i=null;return 0!==t?(r={body:o(),statusCode:t,method:g,headers:{},url:w,rawRequest:f},f.getAllResponseHeaders&&(r.headers=s(f.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),n(i,r,r.body)}}var u,l,f=e.xhr||null;f||(f=e.cors||e.useXDR?new d.XDomainRequest:new d.XMLHttpRequest);var m,w=f.url=e.uri||e.url,g=f.method=e.method||"GET",b=e.body||e.data,y=f.headers=e.headers||{},h=!!e.sync,v=!1,E={body:void 0,headers:{},statusCode:0,method:g,url:w,rawRequest:f};if("json"in e&&!1!==e.json&&(v=!0,y["accept"]||y["Accept"]||(y["Accept"]="application/json"),"GET"!==g&&"HEAD"!==g&&(y["content-type"]||y["Content-Type"]||(y["Content-Type"]="application/json"),b=JSON.stringify(!0===e.json?b:e.json))),f.onreadystatechange=r,f.onload=c,f.onerror=i,f.onprogress=function(){},f.onabort=function(){l=!0},f.ontimeout=i,f.open(g,w,!h,e.username,e.password),h||(f.withCredentials=!!e.withCredentials),!h&&e.timeout>0&&(m=setTimeout((function(){if(!l){l=!0,f.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)}}),e.timeout)),f.setRequestHeader)for(u in y)y.hasOwnProperty(u)&&f.setRequestHeader(u,y[u]);else if(e.headers&&!a(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(f.responseType=e.responseType),"beforeSend"in e&&"function"===typeof e.beforeSend&&e.beforeSend(f),f.send(b||null),f}function p(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(n){}return null}function f(){}e.exports=d,e.exports["default"]=d,d.XMLHttpRequest=r.XMLHttpRequest||f,d.XDomainRequest="withCredentials"in new d.XMLHttpRequest?d.XMLHttpRequest:r.XDomainRequest,c(["get","put","post","patch","head","delete"],(function(e){d["delete"===e?"del":e]=function(t,n,r){return n=u(t,n,r),n.method=e.toUpperCase(),l(n)}}))},33609:function(){},56942:function(){}}]);